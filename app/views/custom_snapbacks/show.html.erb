<main>
	<div class="container-fluid">
		<div class="main-section">
			<div class="product-details row">
				<div class="col-md-7" style="">
					<div class="label-steps text-center">
						<div id="fpd" class="fpd-container fpd-bottom-actions-centered fpd-views-outside" style="margin:auto">
							<input id="ga_price" name="ga_price" type="hidden" value="28.0" />
							<%= image_tag @custom_snapback.image.url, class: "show_img" %>
							<% @upload_logos.each do |upload_logo| %> 
							<%= image_tag upload_logo.logo.url, height:"30px" %>
							<% end %>
							<div class="centered">
								
							</div>
							<div class="fpd-product" title="Front" data-color="Black" data-inches_dimensions='{"width": 0.011527377521613833, "height": 0.013803680981595092024539877, "stitches": 2000}' data-thumbnail="https://uploads.capbeast.com/spree/products/191987/mini/IMG_0131.jpg?1475692677">
								<div class="fpd-views-selection fpd-grid-contain   btns-set  fpd-clearfix" style="display: block;">
									<div class="fpd-item fpd-tooltip tooltipstered fpd-view-active col-md-3">
										<%= image_tag @custom_snapback.image.url, class: "img_size" %><span style="letter-spacing: -2px;">Front</span>
									</div>
									<div class="fpd-item fpd-tooltip tooltipstered col-md-3">
										<%= image_tag @custom_snapback.back_image.url, class: "img_size" %><span>Back</span>
									</div>
									<div class="fpd-item fpd-tooltip tooltipstered col-md-3">
										<%= image_tag @custom_snapback.left_image.url, class: "img_size" %><span>Left side</span>
									</div>
									<div class="fpd-item fpd-tooltip tooltipstered col-md-3">
										<%= image_tag @custom_snapback.right_image.url, class: "img_size" %><span  style="letter-spacing: -2px;">Right side</span>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="col-md-4 col-md-push-1">
					<div class="descr">
						<h1 class="master-product" data-id="1"><%= @custom_snapback.title %></h1>
						<strong class="price product-price selling dynamic_price">$<%= @custom_snapback.price %></strong>
							<a data-toggle="modal" href="#discountModal" class="link">Volume Discounts</a>
						<div class="sizes_div">
							<%= form_for @order_item, remote: true do |f| %>
								<div class="clearfix">
									<h4 class="text-right">Unit Price: <span style="color: green"><%= number_to_currency @custom_snapback.price %></span></h4>
									<label class="qty-field">Total Quantity:</label>
								</div>
								<div class="row">
									<div class="col-sm-12">
										<div class="inline">One Size<br>
										<%= f.number_field :quantity, value: 0, min: 0, width: "60px;" %>
										</div>
									</div>
								</div>
								<div class="clearfix mt10 mb10">
									<div class="input-group-btn">
										<%= f.hidden_field :custom_snapback_id, value: @custom_snapback.id %>
									   <%= f.submit "add_to_cart", class: "btn btn-danger" %>
								    </div>
								</div>
							<% end %>
						</div>
						<div> 
							<label class="pull-left">Colors:</label>
							<ul class="set-color list-inline">
								<li><div class="color-div col-xs-1 fpd-tootip" title="Black" data-index="0" data-url="/products/flat-bill-snapback-new-era/get_variant_image_url?variant_id=2418" style="background: linear-gradient(to bottom, #000000  50%,  #030303 50%);"></div></li>
								<li><div class="color-div col-xs-1 fpd-tootip" title="Charcoal" data-index="1" data-url="/products/flat-bill-snapback-new-era/get_variant_image_url?variant_id=2421" style="background-color: #747D7D;"></div></li>
								<li><div class="color-div col-xs-1 fpd-tootip" title="Deep Navy" data-index="2" data-url="/products/flat-bill-snapback-new-era/get_variant_image_url?variant_id=2420" style="background-color: #15125C;"></div></li>
								<li><div class="color-div col-xs-1 fpd-tootip" title="Stone" data-index="3" data-url="/products/flat-bill-snapback-new-era/get_variant_image_url?variant_id=279" style="background-color: #D6C994;"></div></li>
								<li><div class="color-div col-xs-1 fpd-tootip" title="White" data-index="4" data-url="/products/flat-bill-snapback-new-era/get_variant_image_url?variant_id=2419" style="background-color: #FFFFFF;"></div></li>
								<li><a data-toggle="modal" href="#colorModal1">more colors</a></li>
							</ul>
						</div>
						<h4 class="text-left top-mar">Customize Now!</h4>
						<div class="clearfix">
							<div class="row">
								<a data-toggle="modal" href="#myModal" class="btn btn-default add-text-btn">Add Text</a>
								<a data-toggle="modal" href="#uploadImagePopup" class="btn btn-default add-image-button">Upload Image</a>
							</div>
					<!-- add_text_modal -->
							<div class="product-details modal" id="myModal">
								<div class="modal-dialog">
									<div class="modal-content">
										<br>
										<div class="modal-body">
											<div class="form-group add_text">
												<textarea></textarea>
											</div>
											<%#=render 'add_texts/form' %>
										</div>
										<div class="modal-footer block-form">
										<button class="btn btn-default add_text_done">Done</button>

											<a href="#" data-dismiss="modal" class="btn btn-secondary">Cancel</a>
										</div>
									</div>
								</div>
							</div>
					<!-- Upload_logo_modal -->
							<div class="product-details modal" id="uploadImagePopup">
								<div class="modal-dialog"><br>
									<div class="modal-content"><br>
										<div class="modal-header" style="border-bottom: none;">
											<h5 class="modal-title text-center">We EMBROIDER on all our products</h5>
											<h5 class="modal-title text-center">We also remove any background</h5>
											<%= image_tag "upload.png" %>
											<p>Take a cue from your favorite hats, they all have BOLD logos that look great when stitched. So make sure that the image you are uploading isn't:</p>
											<ul style="font-size:16px">
											<li>A photograph - sorry photos don't stitch well</li>
											<li>An image that includes really tiny text - really small text can't be stitched</li>
											</ul>
										</div>
										<div class="modal-body">
											<div class="row">
												<div class="col-sm-12">
														<%= render 'upload_logos/form' %>
															<h4>My Images</h4>
															<table class="table table-responsive table-striped">
															<tbody class="files" data-toggle="modal-gallery" data-target="#modal-gallery">
															</tbody>
															</table>
												</div>
											</div>
										</div>
										<div class="modal-footer block-form">
											<a href="#" data-dismiss="modal" class="btn btn-secondary">Cancel</a>
										</div>
										<!-- <div class="modal-footer block-form" style="text-align: left !important">
											<div class="row">
												<div class="col-md-6">
													<p>
														<label style="color: red;" class="access_right_label">
															<input type="checkbox" id="access_right"></input> &nbsp;I accept the <a style="color:red;text-decoration:underline" target="_blank" href="/terms-and-conditions">terms and conditions</a> of CapBeast.com
														</label>
													</p>
												</div>
												<div class="col-md-6" style="text-align:right">
													<a href="#" data-dismiss="modal" class="btn btn-opposite">Cancel</a>
													<button class="btn btn-danger" id="done-upload-image" disabled="disabled">Done</button>
												</div>
											</div>
										</div> -->
									</div>
								</div>
							</div>
						</div>
					</div>
					<div id="custom_fpd_tool_bar"></div>
				</div> 
			</div>  
			<div class="row">
				<div class="modal" id="colorModal1">
					<div class="modal-dialog">
						<div class="modal-content">
							<div class="modal-header">
								<button type="button" class="btn btn-close" data-dismiss="modal" aria-hidden="true">×</button>
								<h4 class="modal-title text-center">Colors</h4>
							</div>
							<div class="modal-body">
								<div class="row product-colors-section">
									<div class="col-xs-12 col-sm-12 col-md-6 col-lg-6">
										<div class="product-image">
											<img id="product-zoom" src=https://uploads.capbeast.com/spree/products/191987/original/IMG_0131.jpg?1475692677 alt="" class="img-responsive">
										</div>
									</div>
									<div class="col-xs-12 col-sm-12 col-md-6 col-lg-6">
										<div class="clearfix product-color-information">
											<label class="pull-left">Available Colors</label>
										</div>
										<ul class="set-color list-inline">
										<li class="change_color_image" style="text-decoration: none;" data-index="0" data-url=/products/flat-bill-snapback-new-era/get_variant_image_url?variant_id=2418>
										<div class="variant_source hide" id="https://uploads.capbeast.com/spree/products/191987/original/IMG_0131.jpg?1475692677"></div>
										<div class="" style="background: linear-gradient(to bottom, #000000  50%,  #030303 50%);"></div>
										</li>
										<li class="change_color_image" style="text-decoration: none;" href="#" data-index="1" data-url=/products/flat-bill-snapback-new-era/get_variant_image_url?variant_id=2421>
										<div class="variant_source hide" id="https://uploads.capbeast.com/spree/products/191991/original/IMG_0133.jpg?1475692720"></div>
										<div class="" style="background-color: #747D7D;"></div>
										</li>
										<li class="change_color_image" style="text-decoration: none;" href="#" data-index="2" data-url=/products/flat-bill-snapback-new-era/get_variant_image_url?variant_id=2420>
										<div class="variant_source hide" id="https://uploads.capbeast.com/spree/products/191992/original/IMG_0128.jpg?1475692723"></div>
										<div class="" style="background-color: #15125C;"></div>
										</li>
										<li class="change_color_image" style="text-decoration: none;" href="#" data-index="3" data-url=/products/flat-bill-snapback-new-era/get_variant_image_url?variant_id=279>
										<div class="variant_source hide" id="https://uploads.capbeast.com/spree/products/722/original/IMG_0139.jpg?1412110055"></div>
										<div class="" style="background-color: #D6C994;"></div>
										</li>
										<li class="change_color_image" style="text-decoration: none;" href="#" data-index="4" data-url=/products/flat-bill-snapback-new-era/get_variant_image_url?variant_id=2419>
										<div class="variant_source hide" id="https://uploads.capbeast.com/spree/products/191993/original/IMG_0138.jpg?1475692725"></div>
										<div class="" style="background-color: #FFFFFF;"></div>
										</li>
										<li class="change_color_image" style="text-decoration: none;" data-index="5" data-url=/products/flat-bill-snapback-new-era/get_variant_image_url?variant_id=2426>
										<div class="variant_source hide" id="https://uploads.capbeast.com/spree/products/261065/original/FLAT_BILL_9FIFTY_SNAPBACK__NEW_ERA_CAMO_-_Front_View.jpg?1485186371"></div>
										<div class="" style="background: linear-gradient(to bottom, #030303  50%,  #1F5919  50%);"></div>
										</li>
										</ul>
									</div>
								</div>
							</div>
							<div class="modal-footer block-form">
								<a href="#" data-dismiss="modal" class="btn btn-danger">Cancel</a>
								<button class="btn btn-default" id="done-color-chooser" data-url=/products/flat-bill-snapback-new-era/get_variant_image_url?variant_id=2418 data-index="0" data-modal_id="colorModal1">Done</button>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col-sm-12 col-md-8">
					<div class="product-details-section product-details2">
						<h3 class="text-left">Product Details</h3>
						<hr>
						<p>
						This New Era 6-panel cap highlights all that was good back in the day. The old-school snapback closure and iconic flat bill adds that subtle charm to take you back to the good ol’ days. Customize this design to reflect your true colors. Snapback has 7 positions for adjusting to the right size.
						</p>
					</div>
				</div>
			</div>
			<div class="modal" id="wait_for_upload" data-keyboard=true data-backdrop="static">
				<div class="modal-dialog">
					<div class="modal-content color-scheme-3">
						<div class="modal-header">
							<h3 class="modal-title" align="center">We are processing your request</h3>
						</div>
						<div>
							<div>
								<div class="row">
									<div class="product-detail-section col-xs-12 col-sm-12 col-md-12 col-lg-12">
										<div align="center" class="col-xs-12 col-sm-12 col-md-12 col-lg-12" style="padding: 6px">
											<div class="fpd-loader-wrapper" style=" padding: 30px"><div class="fpd-loader"><div class="fpd-loader-circle"></div></div></div>
										</div>
										<div align="center" class="col-sm-12 col-md-12 col-lg-12" style="margin-top: 16px;margin-bottom: 46px;border-bottom:1px solid #e5e5e5">
											<p>As your images upload to our servers and we process the awesome hat you are making, enjoy this just as awesome joke:</p>
											<p>What did one Hat say to the Other? You stay here, I'll go on a head!</p>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="modal" id="adding_image_to_designer" data-keyboard=true data-backdrop="static">
				<div class="modal-dialog">
					<div class="modal-content">
						<div class="modal-header">
						<h4 class="modal-title">We are processing your request</h4>
						</div>
					<div>
				<div>
				<div class="row">
					<div align="center" class="product-detail-section col-xs-12 col-sm-12 col-md-12 col-lg-12">
						<div class="product-detail-section col-xs-12 col-sm-12 col-md-12 col-lg-12">
							<div class="fpd-loader-wrapper" style=" padding: 30px"><div class="fpd-loader"><div class="fpd-loader-circle"></div></div></div>
						</div>
					</div>
				</div>
			</div>
		
			<div class="modal-footer block-form">
			</div>

			<div class="product-details modal" id="discountModal">
				<div class="modal-dialog">
					<div class="modal-content">
						<div class="modal-header">
							<button type="button" class="btn btn-close" data-dismiss="modal" aria-hidden="true">×</button>
								<h5 class="modal-title text-center">Discounts</h5>
						</div>
						<div class="modal-body">
							<table class="table table-striped table-bordered">
							<thead>
							 <tr>
							<th class="text-center">Quantity</th>
							<th class="text-center">Discount(%)</th>
							</tr>
							</thead>
							<tbody>
							<tr class="text-center">
							<td>1 - 4</td>
							<td>0.0</td>
							</tr>
							<tr class="text-center">
							<td>5 - 9</td>
							<td>10.0</td>
							</tr>
							<tr class="text-center">
							<td>10 - 14</td>
							<td>15.0</td>
							</tr>
							<tr class="text-center">
							<td>15 - 19</td>
							<td>20.0</td>
							</tr>
							<tr class="text-center">
							<td>20 - 49</td>
							<td>25.0</td>
							</tr>
							<tr class="text-center">
							<td>50 - 74</td>
							<td>30.0</td>
							</tr>
							<tr class="text-center">
							<td>75 - 100</td>
							<td>35.0</td>
							</tr>
							<tr class="text-center">
							<td>100 - 10000</td>
							<td>40.0</td>
							</tr>
							</tbody>
							</table>
						</div>
						<div class="modal-footer block-form">
							<a href="#" data-dismiss="modal" class="btn btn-danger">Close</a>
						</div>
					</div>
				</div>
			</div>

			<div class="modal" id="errorPopup">
				<div class="modal-dialog">
					<div class="modal-content">
						<div class="modal-body">
							<br>
							<h4 class="modal-title text-center">Please add text or upload an image onto your hat</h4>
							<br>
						</div>
						<div class="modal-footer">
							<div class="text-center">
							<button class="btn btn-default" id="done-error-popup">Ok</button>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</main>
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script src="//code.jquery.com/ui/1.12.1/jquery-ui.min.js" integrity="sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU=" crossorigin="anonymous"></script>
<script type="text/javascript">window.jQuery || document.write( "<script src=\"/assets/spree/frontend/main/jquery-1.12.4.min-8d35f793d4d7aaba9edcdc7636d15334785fbfa8ca15ee65249dd5ee7a202df1.js\"><\/script>")</script>
<script defer="defer" src="/assets/theme-product-7fccac86edcbb6153ebf6155e14b9407775732cb3ec104da0455ffe1c8e3eb78.js"></script>
<script src="/assets/spree/frontend/noty-lib-6a3361b6968ea1fb8082be17cd12a4cfd5b364b6c83c98f611add411568eb01f.js"></script>
<script>
  var fileUploadErrors = {
  maxFileSize: 'File is too big',
  minFileSize: 'File is too small',
  acceptFileTypes: 'Filetype not allowed',
  maxNumberOfFiles: 'Max number of files exceeded',
  uploadedBytes: 'Uploaded bytes exceed file size',
  emptyResult: 'Empty file upload result'
  };
</script>

<script id="template-upload" type="text/x-tmpl">
  {% for (var i=0, file; file=o.files[i]; i++) { %}
	<tr class="template-upload fade">
	    <td class="preview"><span class="fade"></span></td>
	    <td class="name" style="max-width: 100px;word-wrap: break-word"><span>{%=file.name%}</span></td>
	    <td class="size"><span>{%=o.formatFileSize(file.size)%}</span></td>
	    {% if (file.error) { %}
	    <td class="error" colspan="2"><span class="label label-important">{%=locale.fileupload.error%}</span> {%=locale.fileupload.errors[file.error] || file.error%}</td>
	    {% } else if (o.files.valid && !i) { %}
	    <td>
	      <div class="progress progress-success progress-striped active"><div class="bar" style="width:0%;"></div></div>
	    </td>
	    <td class="start">{% if (!o.options.autoUpload) { %}
	      <button class="btn btn-primary">
	        <i class="icon-upload icon-white"></i>
	        <span>{%=locale.fileupload.start%}</span>
	      </button>
	      {% } %}</td>
	    {% } else { %}
	    <td colspan="2"></td>
	    {% } %}
	    <td class="cancel">{% if (!i) { %}
	      <button class="btn btn-danger" style="min-width: 35px;font-size: .5rem;padding: 10px;">
	        <i class="icon-del"></i>
	      </button>
	      {% } %}</td>
	</tr>
  {% } %}
</script>

<script id="template-download" type="text/x-tmpl">
  {% for (var i=0, file; file=o.files[i]; i++) { %}
    <tr class="template-download fade">
      {% if (file.error) { %}
        <td></td>
        <td class="name" style="max-width: 100px;word-wrap: break-word"><span>{%=file.name%}</span></td>
        <td class="size"><span>{%=o.formatFileSize(file.size)%}</span></td>
        <td class="error" colspan="2"><span class="label label-important">{%=locale.fileupload.error%}</span> {%=locale.fileupload.errors[file.error] || file.error%}</td>
        {% } else { %}
        <td colspan="1">
          {% $('.upload_image_radio_button').attr("checked",false); %}
          {% if($('#access_right').is(':checked'))
           {
             $('#done-upload-image').prop("disabled",false);
             $('.access_right_label').css('color', '#666');
             $('.access_right_label a').css('color', '#666');
           }
           %}
          <input type="radio" value="{%=file.url%}" data-name="{%=file.name%}" data-width="{%=file.width%}" data-height="{%=file.height%}" class="upload_image_radio_button" checked="checked" name="upload_image_radio_button"></input>
        </td>
        <td colspan="1" class="preview">{% if (file.thumbnail_url) { %}
          <a href="{%=file.url%}" title="{%=file.name%}" rel="gallery" download="{%=file.name%}"><img src="{%=file.thumbnail_url%}"></a>
          {% } %}</td>
        <td colspan="2" style="max-width: 100px;word-wrap: break-word" class="name">
          <a href="{%=file.url%}" title="{%=file.name%}" rel="{%=file.thumbnail_url&&'gallery'%}" download="{%=file.name%}">{%=file.name%}</a>
        </td>
        <td colspan="1" class="size"><span>{%=o.formatFileSize(file.size)%}</span></td>
        {% } %}
      	<td colspan="2" class="delete">
	        <button class="delete_design btn btn-danger" data-type="{%=file.delete_type%}" data-url="{%=file.delete_url%}" style="min-width: 35px;font-size: .5rem;padding: 10px;">
	          <i class="icon-del"></i>
	          <!-- <span>{%=locale.fileupload.destroy%}</span> -->
	        </button>
        	<input class="hidden" type="checkbox" name="delete" value="1">
      	</td>
    </tr>
    {% } %}
</script>
<script type="text/javascript">

  // check if jquery is loaded
  	function loadScriptAfterJQueryReady() {
      	setTimeout(function () {
          	var loadScript=true;
          	if (typeof jQuery == 'undefined') {
              	if (typeof window.jQuery == 'undefined') {
                /* jQuery is not loaded */
                  loadScript=false;
                  loadScriptAfterJQueryReady(jsFile);
              	}
          	}
          	if(true==loadScript){
              	$(function () {
                  // Initialize the jQuery File Upload widget:
                  	$('#fileupload').fileupload({autoUpload: true, acceptFileTypes: /(\.|\/)(png||bmp||jpeg||gif)$/i, maxFileSize: 20000000 });
                  // Load existing files:
                  	$.getJSON($('#fileupload').prop('action'), function (files) {
	                    var fu = $('#fileupload').data('blueimpFileupload'),
	                        template;
	                    fu._adjustMaxNumberOfFiles(-files.length);
	                    template = fu._renderDownload(files)
	                        .appendTo($('#fileupload .files'));
	                      // Force reflow:
	                    fu._reflow = fu._transition && template.length &&
	                        template[0].offsetWidth;
	                    template.addClass('in');
	                      $('#loading').remove();
                  	});

              	});
          	}
      	}, 500);
  	}
  	loadScriptAfterJQueryReady();

  	$(".add_text_done").on('click',function(){
  		textarea_val = $(".add_text").find('textarea').val()
  		$(".centered").html(textarea_val)
  		debugger
  		 $('#myModal').modal('hide')


  		// centered

  	})
</script>